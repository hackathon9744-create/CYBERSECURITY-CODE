<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberSec Intelligence — Dashboard</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
  :root {
    --glass-bg: rgba(10,12,18,0.55);
    --card-bg: rgba(255,255,255,0.07);
    --card-border: rgba(255,255,255,0.12);
    --accent: #7c3aed;
    --accent2: #4f46e5;
    --text-muted: rgba(220,230,250,0.55);
  }

  /* Background */
  body {
    background: radial-gradient(circle at 25% 20%, #101827, #050a15 70%);
    font-family: Inter, sans-serif;
    color: #e2e8f0;
    scroll-behavior: smooth;
  }

  /* Header */
  .glass-header {
    background: rgba(10,12,20,0.55);
    backdrop-filter: blur(16px);
    border-bottom: 1px solid rgba(255,255,255,0.06);
    box-shadow: 0 8px 25px rgba(0,0,0,0.35);
  }

  /* Card */
  .card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    backdrop-filter: blur(14px);
    border-radius: 20px;
    padding: 24px;
    transition: all 0.25s ease;
  }
  .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    border-color: rgba(255,255,255,0.2);
  }

  /* Inputs & Textarea */
  input, textarea {
    transition: border 0.25s ease, background 0.25s ease;
  }

  input:focus, textarea:focus {
    border-color: var(--accent);
    background: rgba(255,255,255,0.08);
  }

  /* Buttons */
  .btn-primary {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    transition: 0.3s ease;
    box-shadow: 0 0 20px rgba(124,58,237,0.35);
  }
  .btn-primary:hover {
    filter: brightness(1.15);
    transform: translateY(-1px);
  }

  .btn-secondary:hover {
    border-color: var(--accent);
    color: #fff;
  }

  /* Result Box */
  .result-box {
    white-space: pre-wrap;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.18);
    border-left: 4px solid var(--accent);
    border-radius: 12px;
    padding: 16px;
    margin-top: 16px;
    display: none;
    box-shadow: 0 8px 26px rgba(0,0,0,0.3);
  }

  .muted {
    color: var(--text-muted);
  }

  /* Glow Animation */
  @keyframes subtle-glow {
    0% { box-shadow: 0 0 12px rgba(124,58,237,0.25); }
    50% { box-shadow: 0 0 18px rgba(124,58,237,0.45); }
    100% { box-shadow: 0 0 12px rgba(124,58,237,0.25); }
  }

  .glow {
    animation: subtle-glow 3s infinite ease-in-out;
  }
</style>

</head>

<body>

<!-- HEADER -->
<header class="glass-header fixed top-0 left-0 right-0 z-50">
  <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div style="width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,#7c3aed,#4f46e5);" 
           class="flex items-center justify-center shadow-lg shadow-purple-900/40">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
          <path d="M12 2L20 7v6c0 5-4 9-8 9s-8-4-8-9V7l8-5z" fill="white" opacity="0.12"/>
          <path d="M12 3.3 5 7.9v5.5c0 4.3 3 7.8 7 7.8s7-3.5 7-7.8V7.9L12 3.3z"
            stroke="white" stroke-opacity="0.6" stroke-width="0.6" stroke-linecap="round"/>
        </svg>
      </div>
      <div>
        <div class="text-white text-xl font-semibold tracking-wide">CyberSec Intelligence</div>
        <div class="text-xs muted">AI-Powered Scam Detection</div>
      </div>
    </div>
  </div>
</header>

<!-- CONTENT -->
<main class="pt-28 pb-14">
  <div class="max-w-6xl mx-auto px-4">

    <!-- HERO -->
    <section class="mb-7">
      <div class="card">
        <h1 class="text-2xl lg:text-3xl font-bold">Detect phishing URLs & scam messages instantly.</h1>
        <p class="muted mt-2 text-sm lg:text-base max-w-2xl leading-relaxed">
          Our hybrid ML + LLM engine analyzes suspicious URLs and text messages, detects impersonation,
          identifies fraud signals, and explains the reasoning clearly.
        </p>
      </div>
    </section>

    <!-- GRID -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-7">

      <!-- LEFT -->
      <div class="lg:col-span-2 space-y-7">

        <!-- URL CHECK -->
        <div class="card">
          <h2 class="text-lg font-semibold mb-1">URL Fraud Check</h2>
          <p class="muted text-sm">Paste any suspicious URL below.</p>

          <div class="mt-4 flex flex-col md:flex-row gap-3">
            <input
              id="urlInput"
              type="url"
              placeholder="https://secure-payments-update.xyz/login"
              class="flex-1 px-4 py-3 rounded-lg text-white placeholder:muted outline-none"
            />

            <button
              id="analyzeUrlBtn"
              class="px-4 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-lg font-semibold shadow-md shadow-indigo-900/40"
            >Check URL</button>
          </div>

          <div id="urlResult" class="result-box"></div>
        </div>

        <!-- TEXT CHECK -->
        <div class="card">
          <h2 class="text-lg font-semibold mb-1">Text / Scam Message Detection</h2>
          <p class="muted text-sm">Check SMS, WhatsApp messages, or emails.</p>

          <textarea
            id="textInput"
            rows="5"
            placeholder="Your KYC is pending. Update immediately at https://..."
            class="w-full mt-3 px-4 py-3 rounded-lg text-white placeholder:muted outline-none"
          ></textarea>

          <div class="mt-4 flex gap-3">
            <button id="analyzeTextBtn"
              class="bg-teal-600 px-4 py-3 rounded-lg font-semibold shadow-md shadow-teal-900/40">
              Analyze Text
            </button>

            <button id="sampleBtn"
              class="border border-white/15 px-4 py-3 rounded-lg text-sm muted hover:bg-white/5">
              Sample Input
            </button>
          </div>

          <div id="textResult" class="result-box"></div>
        </div>

      </div>

      <!-- RIGHT -->
      <aside class="space-y-7">

        <div class="card">
          <h3 class="font-semibold">Recent Cyber Attacks</h3>
          <ul id="attackList" class="mt-3 list-disc ml-5 text-sm muted"></ul>
        </div>

        <div class="card">
          <h3 class="font-semibold">Prevention Tips</h3>
          <ul class="mt-3 list-disc ml-5 text-sm muted leading-relaxed">
            <li>Enable 2FA everywhere</li>
            <li>Verify sender identities</li>
            <li>Never trust unknown links</li>
            <li>Check domain spelling & TLD</li>
            <li>Report suspicious messages</li>
          </ul>
        </div>

      </aside>

    </section>

    <!-- FOOTER -->
    <footer class="mt-14 text-center text-gray-500 text-sm">
      © 2025 CyberSec Intelligence — Built for PKP Hackathon
    </footer>

  </div>
</main>

<!-- SCRIPT (unchanged logic, improved formatting) -->
<script>
  const API_BASE = "https://cybersecurity-code-1.onrender.com";

  function show(box, text, err=false) {
    box.style.display = "block";
    box.innerText = text;
    box.style.borderColor = err
      ? "rgba(255,80,80,0.4)"
      : "rgba(255,255,255,0.18)";
  }

  function clearBox(box){ box.style.display="none"; }

  function format(out){
    if(!out) return "No output.";
    let lines = [];

    if(out.final_risk) lines.push("Risk: " + out.final_risk);
    if(out.final_score !== undefined){
      let pct = Math.round(out.final_score * 100);
      lines.push("Probability: " + pct + "%");
    }
    if(out.scam_type) lines.push("Scam Type: " + out.scam_type);

    if(out.explanation){
      lines.push("\nExplanation:");
      if(Array.isArray(out.explanation)) out.explanation.forEach(r => lines.push("- " + r));
      else lines.push(out.explanation);
    }

    return lines.join("\n");
  }

  document.addEventListener("DOMContentLoaded", () => {
    loadAttacks();

    // URL CHECK
    document.getElementById("analyzeUrlBtn").onclick = async () => {
      let box = document.getElementById("urlResult");
      clearBox(box);

      let url = document.getElementById("urlInput").value.trim();
      if(!url){ show(box, "Please enter a URL.", true); return; }

      show(box, "Analyzing URL...");

      try {
        let res = await fetch(API_BASE + "/analyze", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: url, use_openai: true })
        });

        show(box, format(await res.json()));
      } catch (err){
        show(box, "Server error analyzing URL.", true);
      }
    };

    // TEXT CHECK
    document.getElementById("analyzeTextBtn").onclick = async () => {
      let box = document.getElementById("textResult");
      clearBox(box);

      let text = document.getElementById("textInput").value.trim();
      if(!text){ show(box, "Please enter text.", true); return; }

      show(box, "Analyzing text...");

      try {
        let res = await fetch(API_BASE + "/analyze", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: text, use_openai: true })
        });

        show(box, format(await res.json()));
      } catch(err){
        show(box, "Server error analyzing text.", true);
      }
    };

    // SAMPLE INPUT
    document.getElementById("sampleBtn").onclick = () => {
      document.getElementById("textInput").value =
        "Your KYC is pending. Confirm immediately at https://upi-verify-update.top/login";
    };
  });

  async function loadAttacks() {
    try {
      let res = await fetch(API_BASE + "/latest_cyber_attacks");
      let data = await res.json();
      let box = document.getElementById("attackList");

      box.innerHTML = "";
      if(!data.attacks || data.attacks.length === 0){
        box.innerHTML = "<li class='muted'>No recent alerts available.</li>";
        return;
      }

      data.attacks.forEach(title => {
        let li = document.createElement("li");
        li.textContent = title;
        li.className = "text-sm text-gray-300";
        box.appendChild(li);
      });

    } catch (err) {
      console.log("Failed to load cyber attacks:", err);
    }
  }
</script>

</body>
</html>

